<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/estilos3.css">
</head>
<body>
    
    <div class="formulario_add">
        <h1>Ingrese los datos del producto</h1>
        <form>
        <label for="Categoria">Escoja la cateoria a la que pertenece</label><br>
        <select id="valorcategoria">
        <option for="1">1.Categoría para hombres</option>
        <option for="2">2.Categoría para mujeres</option>
        <option for="3">3.Categoría Unisex</option>
    </select><br>
        <label for="Descripción">Describa al producto</label><br>
        <input type="text" name="descripcion"     id="descripcion"><br>
        <label for="precio">Precio por unidad</label><br>
        <input type="number" name="precio" oninput="calculartotal()"    id="precio"><br>
        <label for="stock">Stock</label><br>
        <input type="number" name="stock"  oninput="calculartotal()"  id="stock"><br>
        <label for="total">Costo total</label><br>
        <input type="number" name="total" id="total" readonly><br>
        <label>Imagen del producto</label><br>
        <input type="file" name="imagen" id="imagen"><br>
        <input type="submit" value="Registrar"><br>
    </form>
    </div>
    <script>
        function calculartotal(){
            var precio= parseFloat(document.getElementById("precio").value)||0;
            var stock= parseFloat(document.getElementById("stock").value)||0;
    
            var total=precio*stock;
            document.getElementById("total").value = total.toFixed(2);
        }
   
    

       
        document.getElementById("formulario_add").addEventListener("submit", function(event) {
            event.preventDefault(); // Evitar el envío del formulario por defecto
            const valorcategoria= document.getElementById("valorcategoria").value;
            const cat_id=valorcategoria.value;
            const descripcion = document.getElementById("descripcion").value;
            const precio = document.getElementById("precio").value;
            const stock = document.getElementById("stock").value;
            const total = document.getElementById("total").value;
            
            // Enviar datos al servidor para registrar el usuario
            fetch('/producto', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ cat_id, descripcion, precio, stock, total })
            })
            .then(response => response.json())
            .then(data => {
                alert(data.message); // Muestra el mensaje de respuesta
                if (data.message === 'Producto registrado con éxito') {
                    // Redirigir al login.html
                    window.location.href = 'principal.html';
                }
            })
            .catch(error => {
                console.error('Error:', error);
            });
        });

    </script>
</body>
</html>